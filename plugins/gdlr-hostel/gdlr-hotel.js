!function(e){"use strict";e.fn.gdlr_datepicker_range=function(){var t=e(this).attr("data-dfm")?e(this).attr("data-dfm"):"yy-mm-dd";e(this).datepicker({minDate:0,dateFormat:t,numberOfMonths:[1,2],beforeShowDay:function(r){var a=e.datepicker.parseDate(t,e("#gdlr-check-in").val()),n=e.datepicker.parseDate(t,e("#gdlr-check-out").val());return[!0,a&&(r.getTime()==a.getTime()||n&&r>=a&&r<=n)?"dp-highlight":""]},onSelect:function(r,a){var n=e.datepicker.parseDate(t,e("#gdlr-check-in").val()),i=e.datepicker.parseDate(t,e("#gdlr-check-out").val());!n||i?(e("#gdlr-check-in").datepicker("setDate",r),e("#gdlr-check-out").val("")):e("#gdlr-check-out").datepicker("setDate",r).trigger("change")},closeText:objectL10n.closeText,currentText:objectL10n.currentText,monthNames:objectL10n.monthNames,monthNamesShort:objectL10n.monthNamesShort,dayNames:objectL10n.dayNames,dayNamesShort:objectL10n.dayNamesShort,dayNamesMin:objectL10n.dayNamesMin,firstDay:objectL10n.firstDay})},e.fn.gdlr_datepicker=function(){e(this).each(function(){if(e(this).attr("data-dfm")){var t=new Date(e(this).val());e(this).val(e.datepicker.formatDate(e(this).attr("data-dfm"),t))}e(this).datepicker({dateFormat:e(this).attr("data-dfm")?e(this).attr("data-dfm"):"yy-mm-dd",minDate:0,altField:e(this).attr("data-dfm")?e(this).siblings(".gdlr-datepicker-alt"):"",altFormat:e(this).attr("data-dfm")?"yy-mm-dd":"",changeMonth:!0,changeYear:!0,onSelect:function(t,r){e(this).trigger("change"),e("#gdlr-datepicker-range").datepicker("refresh")},closeText:objectL10n.closeText,currentText:objectL10n.currentText,monthNames:objectL10n.monthNames,monthNamesShort:objectL10n.monthNamesShort,dayNames:objectL10n.dayNames,dayNamesShort:objectL10n.dayNamesShort,dayNamesMin:objectL10n.dayNamesMin,firstDay:objectL10n.firstDay})})},e.fn.gdlr_single_booking=function(){var t=e(this);e(this).find(".gdlr-datepicker").gdlr_datepicker(),e(this).on("change","#gdlr-night, #gdlr-check-in",function(){var e=t.find("#gdlr-check-in"),r=t.find("#gdlr-check-out"),a=t.find("#gdlr-night");if(e.val()){var n=e.datepicker("getDate","+1d");n.setDate(n.getDate()+parseInt(a.val())),r.datepicker("setDate",n);var i=e.datepicker("getDate","+1d");i.setDate(i.getDate()+1),r.datepicker("option","minDate",i)}}),e(this).on("change","#gdlr-check-out",function(){var r=t.find("#gdlr-check-in").datepicker("getDate"),a=(e(this).datepicker("getDate")-r)/864e5;if(r&&a>0){var n=t.find("#gdlr-night");0==n.children('option[value="'+a+'"]').length&&n.append('<option value="'+a+'" >'+a+"</option>"),e("#gdlr-night").val(a)}}),e(this).on("change","#gdlr-room-number",function(){var r=parseInt(e(this).val()),a=t.find("#gdlr-reservation-people-amount-wrapper"),n=r-a.children().length;if(n>0)for(var i=0;i<n;i++){var o=a.children(":first-child").clone().hide();o.find(".gdlr-reservation-people-title span").html(a.children().length+1),o.appendTo(a).slideDown(200)}else n<0&&a.children().slice(n).slideUp(200,function(){e(this).remove()})}),e(this).submit(function(){if(""==e(this).find("select[name=gdlr-hotel-branches]").val())return e(this).find("#please-select-branches").slideDown(),!1})},e.fn.gdlr_hotel_booking=function(){var t={wrapper:e(this),resv_bar:e(this).find("#gdlr-reservation-bar"),room_form:e(this).find("#gdlr-reservation-bar-room-form"),date_form:e(this).find("#gdlr-reservation-bar-date-form"),summary_form:e(this).find("#gdlr-reservation-bar-summary-form"),service_form:e(this).find("#gdlr-reservation-bar-service-form"),proc_bar:e(this).find("#gdlr-booking-process-bar"),content_area:e(this).find("#gdlr-booking-content-inner")},r=function(){t.resv_bar.on("change","#gdlr-night, #gdlr-check-in",function(){var r=t.resv_bar.find("#gdlr-check-in"),a=t.resv_bar.find("#gdlr-check-out"),n=t.resv_bar.find("#gdlr-night");if(r.val()){var i=r.datepicker("getDate","+1d");i.setDate(i.getDate()+parseInt(n.val())),a.datepicker("setDate",i);var o=r.datepicker("getDate","+1d");o.setDate(o.getDate()+1),e("#gdlr-datepicker-range").datepicker("refresh"),a.datepicker("option","minDate",o)}}),t.resv_bar.on("change","#gdlr-check-out",function(){var r=t.resv_bar.find("#gdlr-check-in").datepicker("getDate"),a=(e(this).datepicker("getDate")-r)/864e5;if(r&&a>0){var n=t.resv_bar.find("#gdlr-night");0==n.children('option[value="'+a+'"]').length&&n.append('<option value="'+a+'" >'+a+"</option>"),e("#gdlr-night").val(a)}}),t.resv_bar.on("change","#gdlr-room-number",function(){var r=parseInt(e(this).val()),a=t.resv_bar.find("#gdlr-reservation-people-amount-wrapper"),n=r-a.children().length;if(n>0)for(var i=0;i<n;i++){var o=a.children(":first-child").clone().hide();o.find(".gdlr-reservation-people-title span").html(a.children().length+1),o.appendTo(a).slideDown(200)}else n<0&&a.children().slice(n).slideUp(200,function(){e(this).remove()})}),t.resv_bar.on("click","#gdlr-reservation-bar-button",function(){return n.change_state({state:2}),!1}),t.resv_bar.on("change",'#gdlr-check-in, #gdlr-night, #gdlr-check-out, #gdlr-room-number, #gdlr-hotel-branches, select[name="gdlr-adult-number[]"], select[name="gdlr-children-number[]"]',function(){parseInt(t.proc_bar.attr("data-state"))>1&&t.room_form.slideUp(function(){e(this).html("").removeClass("gdlr-active"),n.change_state({state:2})})})},a=function(e){t.proc_bar.attr("data-state",e),t.proc_bar.children('[data-process="'+e+'"]').addClass("gdlr-active").siblings().removeClass("gdlr-active")},n={init:function(){t.wrapper.find(".gdlr-datepicker").gdlr_datepicker(),t.wrapper.find("#gdlr-datepicker-range").gdlr_datepicker_range(),r(),this.room_select(),this.contact_submit()},room_select:function(){t.content_area.on("click",".price-breakdown-close",function(){return e(this).closest(".price-breakdown-wrapper").fadeOut(200),!1}),t.content_area.on("click",".gdlr-price-break-down",function(){e(this).children(".price-breakdown-wrapper").fadeIn(200)}),t.content_area.on("click",".gdlr-room-selection",function(){return t.room_form.find(".gdlr-active input").val(e(this).attr("data-roomid")),n.change_state({state:2,room_id:e(this).attr("data-roomid")}),!1}),t.content_area.on("click",".gdlr-pagination a",function(){return n.change_state({paged:e(this).attr("data-paged"),state:2}),!1}),t.room_form.on("click",".gdlr-reservation-change-room",function(){return e(this).closest(".gdlr-reservation-room").find("input").val(""),n.change_state({state:2}),!1}),t.summary_form.on("click","#gdlr-edit-booking-button",function(){return t.room_form.find(".gdlr-reservation-room:first-child input").val(""),n.change_state({state:2}),!1}),t.summary_form.on("change",'input[name="pay_deposit"]',function(){return"true"==e(this).val()?(t.summary_form.find(".gdlr-price-deposit-inner-wrapper").slideDown(),t.summary_form.find(".gdlr-price-summary-grand-total").removeClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="true"]').closest("span").addClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="false"]').closest("span").removeClass("gdlr-active")):(t.summary_form.find(".gdlr-price-deposit-inner-wrapper").slideUp(),t.summary_form.find(".gdlr-price-summary-grand-total").addClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="true"]').closest("span").removeClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="false"]').closest("span").addClass("gdlr-active")),!1})},contact_submit:function(){t.content_area.on("change",".gdlr-room-service-checkbox input",function(){e(this).is(":checked")?e(this).parent("label").addClass("gdlr-active").siblings("input").prop("disabled",!1):e(this).parent("label").removeClass("gdlr-active").siblings("input").prop("disabled",!0)}),t.content_area.on("click",".gdlr-room-selection-next",function(){return n.change_state({state:3,service:e(this).siblings(".gdlr-booking-service-wrapper").children("form")}),!1}),t.content_area.on("click",".gdlr-booking-contact-submit",function(){return e(this).hasClass("gdlr-clicked")||(e(this).addClass("gdlr-clicked"),t.content_area.find(".gdlr-error-message").slideUp(),n.change_state({state:3,contact:e(this).closest("form"),contact_type:"contact"})),!1}),t.content_area.on("click",".gdlr-booking-payment-submit",function(){return e(this).hasClass("gdlr-clicked")||(e(this).addClass("gdlr-clicked"),t.content_area.find(".gdlr-error-message").slideUp(),n.change_state({state:3,contact:e(this).closest("form"),contact_type:"instant_payment"})),!1}),t.content_area.on("click",'.gdlr-payment-method input[name="payment-method"]',function(){e(this).parent("label").addClass("gdlr-active").siblings().removeClass("gdlr-active")})},change_state:function(r){if(""==t.resv_bar.find("select[name=gdlr-hotel-branches]").val())return t.resv_bar.find("#please-select-branches").slideDown(),!1;t.resv_bar.find("#please-select-branches").slideUp(),t.resv_bar.find("#gdlr-reservation-bar-button").slideUp(200,function(){e(this).remove()}),t.content_area.animate({opacity:.2}),t.content_area.parent().addClass("gdlr-loading");var n={action:t.resv_bar.attr("data-action"),data:t.resv_bar.serialize(),state:r.state};r.room_id&&(n.room_id=r.room_id),r.service&&(n.service=r.service.serialize(),n.service||(n.service="service=none")),r.contact&&(n.contact=r.contact.serialize()),r.contact_type&&(n.contact_type=r.contact_type),r.paged&&(n.paged=r.paged),e.ajax({type:"POST",url:t.wrapper.attr("data-ajax"),data:n,dataType:"json",error:function(e,t,r){console.log(e,t,r)},success:function(r){if(r.state){if(a(r.state),r.content){var n=t.content_area.height();t.content_area.html(r.content);var i=t.content_area.height();t.content_area.parent().removeClass("gdlr-loading"),t.content_area.height(n).animate({opacity:1,height:i},function(){e(this).css("height","auto")})}if(r.summary_form)if(t.summary_form.hasClass("gdlr-active")){n=t.summary_form.height();t.summary_form.html(r.summary_form);i=t.summary_form.height();t.summary_form.height(n).animate({height:i},function(){e(this).css("height","auto")})}else t.summary_form.html(r.summary_form).slideDown().addClass("gdlr-active");if(r.service&&t.service_form.html(r.service),2==r.state){if(t.summary_form.slideUp(function(){e(this).removeClass("gdlr-active")}),t.date_form.slideDown(),r.room_form)if(t.room_form.hasClass("gdlr-active")){n=t.room_form.height();t.room_form.html(r.room_form);i=t.room_form.height();t.room_form.height(n).animate({height:i},function(){e(this).css("height","auto")})}else t.room_form.html(r.room_form).slideDown().addClass("gdlr-active")}else if(3==r.state&&(t.room_form.slideUp(function(){e(this).removeClass("gdlr-active")}),t.date_form.slideUp(),r.error_message&&(t.content_area.find(".gdlr-button").removeClass("gdlr-clicked"),t.content_area.find(".gdlr-error-message").html(r.error_message).slideDown(),t.content_area.parent().removeClass("gdlr-loading"),t.content_area.animate({opacity:1})),r.payment&&"paypal"==r.payment)){var o=t.content_area.find("form.gdlr-booking-contact-form");o.attr("method","post"),o.attr("action",r.payment_url),o.append(r.addition_part),o.submit()}}}})}};return n.init(),this},e(document).ready(function(){e("#gdlr-single-booking-content").gdlr_hotel_booking(),e("body.single #gdlr-reservation-bar, #gdlr-hotel-availability").gdlr_single_booking(),e(".gdlr-room-category-item").on("mouseover",".gdlr-room-category-thumbnail",function(){e(this).children("img").transition({scale:1.1,duration:200,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay").animate({opacity:.6},{duration:150,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay-icon").animate({opacity:1},{duration:150,queue:!1})}),e(".gdlr-room-category-item").on("mouseout",".gdlr-room-category-thumbnail",function(){e(this).children("img").transition({scale:1,duration:200,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay").animate({opacity:0},{duration:150,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay-icon").animate({opacity:0},{duration:150,queue:!1})})})}(jQuery);